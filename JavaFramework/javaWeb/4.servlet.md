##  Servletï¼ˆé‡ç‚¹ï¼‰

###  ä»€ä¹ˆæ˜¯servletï¼Ÿ

> - JavaEEè§„èŒƒä¹‹ä¸€ï¼Œå³æ¥å£
> - JavaWebä¸‰å¤§ç»„ä»¶ä¹‹ä¸€ï¼ŒServletç¨‹åºã€Filterè¿‡æ»¤å™¨ã€Listenerç›‘å¬å™¨
> - è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„javaå°ç¨‹åºï¼›**å¯æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶å“åº”æ•°æ®ç»™å®¢æˆ·ç«¯**



###  Servletç”Ÿå‘½å‘¨æœŸ

1. æ‰§è¡ŒServletæ„é€ å™¨ï¼ˆç¬¬ä¸€æ¬¡è®¿é—®è¢«è°ƒç”¨ï¼‰
2. æ‰§è¡Œinitåˆå§‹åŒ–ï¼ˆç¬¬ä¸€æ¬¡è®¿é—®è¢«è°ƒç”¨ï¼‰
3. æ‰§è¡Œserviceæ–¹æ³•ï¼ˆæ¯æ¬¡è®¿é—®è°ƒç”¨ï¼‰
4. æ‰§è¡Œdestoryé”€æ¯æ–¹æ³•	ï¼ˆåœæ­¢å·¥ç¨‹æ—¶è¢«è°ƒç”¨ï¼‰



###  å®ç°Servletç¨‹åº

> æ³¨æ„ï¼šå®ç°æ¥å£æ—¶å¦‚æœæ‰¾ä¸åˆ°è¯¥æ¥å£ï¼Œéœ€è¦åœ¨tomcat/libç›®å½•ä¸‹å°†jsp-api.jarå’Œservlet-api.jaråŒ…å¯¼å…¥å³å¯

1. å®ç°æ–¹æ³•ï¼š

   - ####  æ–¹æ³•ä¸€ï¼šç¼–å†™ç±»**å®ç°Servletæ¥å£**ï¼ˆ*å¼€å‘ä¸­ä¸å¸¸ç”¨*ï¼‰

     å®ç°serviceæ–¹æ³•ï¼Œå¤„ç†è¯·æ±‚ï¼Œå“åº”æ•°æ®

     ```java
     package com.loy.servlet;
     import javax.servlet.*;
     import java.io.IOException;
     public class MyServlet implements Servlet {
         @Override
         public void init(ServletConfig servletConfig) throws ServletException {
         }
         @Override
         public ServletConfig getServletConfig() {
             return null;
         }
         /**
          * ä¸“é—¨ç”¨äºå¤„ç†è¯·æ±‚å’Œå“åº”çš„æ–¹æ³•
          * @param servletRequest
          * @param servletResponse
          * @throws ServletException
          * @throws IOException
          */
         @Override
         public void service(ServletRequest servletRequest, ServletResponse servletResponse) throws ServletException, IOException {
             System.out.println("MyServletçš„serviceæ–¹æ³•è¢«è®¿é—®äº†ï¼");
         }
         @Override
         public String getServletInfo() {
             return null;
         }
         @Override
         public void destroy() {
         }
     }
     ```

   - ####   æ–¹æ³•äºŒï¼šç¼–å†™ç±»**ç»§æ‰¿HttpServlet**ï¼ˆ*å®é™…å¼€å‘ç»å¸¸ä½¿ç”¨*ï¼‰

     ```java
     package com.loy.servlet;
     import javax.servlet.ServletException;
     import javax.servlet.http.HttpServlet;
     import javax.servlet.http.HttpServletRequest;
     import javax.servlet.http.HttpServletResponse;
     import java.io.IOException;
     
     public class MyMainServlet extends HttpServlet {
         /**
          * å¤„ç†getä¸šåŠ¡é€»è¾‘
          * @param req
          * @param resp
          * @throws ServletException
          * @throws IOException
          */
         @Override
         protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
             System.out.println("ç»§æ‰¿æ”¹ç±»åçš„doGetæ–¹æ³•");
         }
     
         /**
          * å¤„ç†postä¸šåŠ¡é€»è¾‘
          * @param req
          * @param resp
          * @throws ServletException
          * @throws IOException
          */
         @Override
         protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
             System.out.println("ç»§æ‰¿è¯¥ç±»åçš„doPostæ–¹æ³•");
         }
     }
     
     ```

2. åœ¨web.xmlä¸­é…ç½®servletç¨‹åºè®¿é—®åœ°å€

   ```xml
   <?xml version="1.0" encoding="UTF-8"?>
   <web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
            version="4.0">
   
   <!--    servletæ ‡ç­¾ç»™tomcaté…ç½®servletç¨‹åº-->
       <servlet>
   <!--        ç»™servletèµ·åˆ«åï¼ˆç±»åï¼‰-->
           <servlet-name>MyServlet</servlet-name>
   <!--        å¯¹åº”ç±»çš„å…¨ç±»å-->
           <servlet-class>com.loy.servlet.MyServlet</servlet-class>
       </servlet>
       
   <!--    é…ç½®servletç¨‹åºè®¿é—®åœ°å€-->
       <servlet-mapping>
   <!--        å‘Šè¯‰æœåŠ¡å™¨å½“å‰é…ç½®çš„åœ°å€ç»™å“ªä¸ªservletç¨‹åºä½¿ç”¨-->
           <servlet-name>MyServlet</servlet-name>
   <!--        é…ç½®è®¿é—®åœ°å€ï¼šåœ¨http://ip:port/å·¥ç¨‹è·¯å¾„ï¼ˆé…ç½®æœåŠ¡å™¨æ—¶çš„è·¯å¾„ï¼‰/myServlet-->
           <url-pattern>/myServlet</url-pattern>
       </servlet-mapping>
   </web-app>
   ```

   

###  Servletç»§æ‰¿ä½“ç³»

> HttpServlet ----ç»§æ‰¿----> GenericServlet ----å®ç°----> Servlet

- Servletæ¥å£ï¼Œè´Ÿè´£å®šä¹‰Servletç¨‹åºè®¿é—®è§„èŒƒ
- GenericServletç±»å®ç°Servletæ¥å£ï¼Œå¹¶æŒæœ‰ServletConfigç±»çš„å¼•ç”¨
- HttpServletæŠ½å–ç±»å®ç°äº†serviceæ–¹æ³•ï¼Œå¹¶åšè¯·æ±‚åˆ†å‘å¤„ç†

#### 		

#### 	ServletConfigç±»ï¼ˆä½œç”¨äºå•ä¸ªservletç¨‹åºï¼‰

â€‹		æè¿°ï¼šç”¨äºé…ç½®servletç¨‹åºä¿¡æ¯

â€‹		ä½œç”¨ï¼š

1. è·å–servletç¨‹åºçš„åˆ«åï¼ˆservlet-nameçš„å€¼ï¼‰
2. è·å–åˆå§‹åŒ–å‚æ•°init-param
3. è·å–ServletContextå¯¹è±¡

æ³¨æ„ï¼šé‡å†™initæ–¹æ³•åéœ€è¦è°ƒç”¨super.init(config)æ–¹æ³•

```java
public void init(ServletConfig config) throws ServletException {
        super.init(config);//ç”±äºåº•å±‚GenericServletç±»ä¿å­˜äº†configï¼›å½“é‡å†™åï¼Œç¨‹åºä¼šè®¿é—®æœ¬ç±»çš„configï¼Œæ²¡æœ‰çš„è¯ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸
    }

```



####  ServletContextå¯¹è±¡ï¼ˆä½œç”¨ä¸æ•´ä¸ªwebå·¥ç¨‹ï¼‰

æè¿°ï¼š

1. æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¡¨ç¤ºservletä¸Šä¸‹æ–‡å¯¹è±¡
2. ä¸€ä¸ªwebå·¥ç¨‹åªæœ‰ä¸€ä¸ªè¯¥å¯¹è±¡å®ä¾‹
3. æ˜¯ä¸€ä¸ªåŸŸå¯¹è±¡ï¼ˆå¯ä»¥åƒMapä¸€æ ·å­˜å–æ•°æ®çš„å¯¹è±¡ï¼›åŸŸè¡¨ç¤ºå­˜å–æ•°æ®èŒƒå›´ï¼‰

ç±»æ¯”mapï¼š

|        |      å­˜æ•°æ®      |     å–æ•°æ®     |     åˆ é™¤æ•°æ®      |
| :----: | :--------------: | :------------: | :---------------: |
|  Map   |      put()       |     get()      |     remove()      |
| åŸŸå¯¹è±¡ | setAttributeï¼ˆï¼‰ | getAttribute() | removeAttribute() |

ä½œç”¨ï¼š

- è·å–web.xmlä¸­é…ç½®çš„context-param
- è·å–å½“å‰å·¥ç¨‹è·¯å¾„
- è·å–å·¥ç¨‹éƒ¨ç½²ååœ¨æœåŠ¡å™¨ä¸Šçš„ç»å¯¹è·¯å¾„
- åƒmapä¸€æ ·å­˜å–æ•°æ®

> ğŸ“æ³¨æ„ï¼š
>
> ServletContextåœ¨webå·¥ç¨‹å¯åŠ¨éƒ¨ç½²æ—¶åˆ›å»ºï¼Œåœæ­¢æ—¶é”€æ¯ï¼›å¹¶ä¸”ä¸€æ—¦åˆ›å»ºï¼Œåœ¨*å…¶ä»–servletç¨‹åºä¹Ÿèƒ½è®¿é—®*



------

####  å¸¸è§çŠ¶æ€ç 

- 200			è¯·æ±‚æˆåŠŸ
- 302          è¯·æ±‚é‡å®šå‘
- 404          è¯·æ±‚æœåŠ¡å™¨æ”¶åˆ°ï¼Œå¯èƒ½æ•°æ®ä¸å­˜åœ¨
- 500          è¡¨ç¤ºæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æœåŠ¡å™¨å†…éƒ¨å‡ºç°é”™è¯¯ 
