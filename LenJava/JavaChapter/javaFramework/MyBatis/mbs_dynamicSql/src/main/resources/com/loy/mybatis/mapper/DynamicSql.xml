<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loy.mybatis.mapper.DynamicSql">
    <!--    List<Employee> getEmpByWhere();-->
    <select id="getEmpByWhere" resultType="Employee">
        select id,ename as empName,age from employee
        <where>
            <if test="empName !=null and empName!='' ">
                and ename=#{empName}
            </if>
            <if test="age !=null and age != 0">
                and age=${age}
            </if>
        </where>
    </select>

    <select id="getEmpByTrim" resultType="Employee">
        select id,ename as empName,age from employee
        <trim prefix="where" suffixOverrides="and | or">
            <if test="empName !=null and empName!='' ">
                 ename=#{empName} and
            </if>
            <if test="age !=null and age != 0">
                  age=${age} or
            </if>
        </trim>
    </select>

<!--    List<Employee> getEmpByCwo(Employee employee);-->
    <select id="getEmpByCwo" resultType="Employee">
        select id,ename as empName,age from employee
        <where>
            <choose>
                <when test="empName !=null and empName!='' ">
                    ename=#{empName}
                </when>
                <when test="age !=null and age != 0">
                    age=${age}
                </when>
                <otherwise>
                    did=1;
                </otherwise>
            </choose>
        </where>
    </select>
    
    
    
<!--    批量删除-->
<!--    int deleteEmpByForeach(Integer[] ids);-->
    <delete id="deleteEmpByForeach">
        delete from employee where id in
        (
        <foreach collection="ids" item="id" separator=",">
            #{id}
        </foreach>
        )
    </delete>

<!--    int insertEmpByForeach(@Param("employeeList") List<Employee> employeeList);-->
    <insert id="insertEmpByForeach">
        insert into employee values
        <foreach collection="employeeList" item="emp" separator=",">
            (null,#{emp.empName},#{emp.age},1)
        </foreach>
    </insert>

<!--    sql标签：
            将常用的字段提取，使用include引用
-->
    <sql id="sqlEmp">id,ename as empName,age</sql>
    <select id="sqlTest" resultType="Employee">
    select <include refid="sqlEmp"></include> from employee;
    </select>

</mapper>
